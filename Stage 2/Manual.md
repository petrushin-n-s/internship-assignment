# Руководство программисту
####  Второй этап стажировки
##### Выполнил: Петрушин Никита Сергеевич

------------

###### Техническое задание на разработку
  «Модуль для работы с периферийными устройствами»

1. Наименование разрабатываемого модуля

«Модуль для работы с периферийными устройствами».

2. Назначение и область применения

Разрабатываемый модуль предназначен для выполнения взаимодействия с
внешними аппаратными устройствами с использованием интерфейсных шин
UART, I2C, GPIO.

------------

###### Подготовка к работе микрокомпьютера Orange Pi Zero
Для начала работы необходимо скачать образ Armbian для Orange Pi с  [официального сайта](https://www.armbian.com/orange-pi-zero/ "официального сайта"). Далее с помощью программы [balenaetcher](https://www.balena.io/etcher/ "balenaetcher") записать образ системы на карту microSD.
Запустив микрокомпьютер, необходимо получить доступ к его терминалу. В Windows это можно сделать через утилиту PuTTY. Произведя первичную настройку и обновив программное обеспечение, можно для удобства подключить микрокомпьютер к локальной сети и дальнейшую работу с ним производить не через консольный кабель, а по SSH.

###### Установка библиотеки WiringOP

```bash
#Скачавание библиотеки:
sudo apt-get install git
git clone https://github.com/xpertsavenue/WiringOPZero.git

#Установка библиотеки
chmod +x ./build
sudo ./build
```

###### Подготовка к работе AVR ATmega328P
Программирование микроконтроллера ATmega328P можно производить через [Arduino IDE ](https://www.arduino.cc/en/software "Arduino IDE ").
Для записи программы в микроконтроллер необходимо его подключить к ПК
через программатор USB ISP.

**Важно!** Для корректной работы программатора и COM-портов в ОС Windows 10 необходимо установить драйвера типа PL23XX USB-to-Serial, а также библиотеку типа libusbK (последнее можно сделать с помощью программы [Zadig](https://zadig.akeo.ie/ "Zadig"))

Подключать различные библиотеки (типа` <DHT.h>`) можно с помощью встроенного менеджера библиотек. Его можно вызвывать комбинаций клавиш **Ctrl+Shift+I**.

###### Выполнение взаимодействия с внешними аппаратными устройствами с использованием интерфейсных шин UART, I2C, GPIO

**Важно!** Для корректной работы интерфейсов UART и I2C в микрокомпьютере Orange Pi Zero необходимо включить их в меню конфигурации:
```bash
sudo armbian-config
```
В появившемся окне необходимо выбрать *System | System and Security
SettingsHardware | Toogle Hardware Configuration: UART, I2C, etc* в списке выбрать
**UART2 и i2c0**, поставить галочку напротив, сохранить и перезагрузить одноплатный компьютер.

Для редактирования файлов с кодом можно применять как "терминальные" редакторы типа `nano`, так и сторонние редакторы, например в ОС Windows. Для этого можно использовать утилиту [WinSCP](https://winscp.net/eng/download.php "WinSCP"). Через данную утилиту можно открыть файлы программ, например, в редакторе Atom.

Компиляция и запуск программ производится следующим образом:

```bash
sudo gcc Hello.c -o hello -lwiringPi -lpthread
sudo ./hello
```
Для компиляции и загрузки через программатор программы в ATmega328P необходимо в Arduino IDE выполнить следующие действия:
*Скетч > проверить/компилировать, затем Скетч > Загрузка через
программатор (или можно использовать сочетание клавиш Ctrl+Shift+U).*
